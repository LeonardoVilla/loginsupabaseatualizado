name: Commit DiÃ¡rio CuiabÃ¡

on:
  schedule:
    - cron: "0 */8 * * *"  # Executa a cada 8 horas
  workflow_dispatch:

jobs:
  commit-automatico:
    runs-on: ubuntu-latest
    steps:
      # 1ï¸âƒ£ Clonar o repositÃ³rio
      - name: Clonar repositÃ³rio
        uses: actions/checkout@v4

      # 2ï¸âƒ£ Adicionar entrada enumerada no README.md
      - name: Adicionar entrada no README
        run: |
          # Define o fuso horÃ¡rio para CuiabÃ¡
          export TZ="America/Cuiaba"
          
          # Se README.md existir, pega o Ãºltimo nÃºmero; senÃ£o, comeÃ§a do 0
          if [ -f README.md ]; then
            last_number=$(awk '/^[0-9]+\./ {n=$1} END{print n}' README.md | tr -d '.')
            if [ -z "$last_number" ]; then
              last_number=0
            fi
          else
            last_number=0
          fi

          # Incrementa
          next_number=$((last_number + 1))

          # Adiciona a linha numerada no README.md
          echo "$next_number. ğŸ“Œ $(date '+%d/%m/%Y %H:%M:%S') â€” Commit automÃ¡tico CuiabÃ¡" >> README.md

      # 3ï¸âƒ£ Commit e push
      - name: Commit e push
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ“Œ Commit automÃ¡tico CuiabÃ¡"
